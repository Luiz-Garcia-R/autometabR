% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabolNormalize.R
\name{metabol.normalize}
\alias{metabol.normalize}
\title{Normalize Metabolomics Data}
\usage{
metabol.normalize(
  imp_data,
  method = "log2",
  remove_zeros = FALSE,
  remove_outliers = TRUE,
  impute = TRUE,
  impute_shift = 1.8,
  impute_scale = 0.3,
  max_missing_prop_per_group = 0.5,
  pseudo_count = NULL,
  clip_negative_log = TRUE,
  collapse_correlated = TRUE,
  cor_threshold = 0.95,
  assign_result = TRUE,
  assign_name = "normalized_data",
  envir = parent.frame()
)
}
\arguments{
\item{imp_data}{A \code{metabolR} object containing raw data (\code{data}) and metadata (\code{metadata}).}

\item{method}{Normalization method: "log2" (default) or "log10".}

\item{remove_zeros}{Logical, whether to remove metabolites that are all zeros. Default FALSE.}

\item{remove_outliers}{Logical, whether to replace outliers with NA. Default TRUE.}

\item{impute}{Logical, whether to perform global imputation. Default TRUE.}

\item{impute_shift}{Shift applied to median for imputation. Default 1.8.}

\item{impute_scale}{Scale applied to SD for imputation. Default 0.3.}

\item{max_missing_prop_per_group}{Maximum allowed missing proportion per group. Default 0.5.}

\item{pseudo_count}{Numeric vector or NULL, pseudo-count per metabolite. Default NULL (computed automatically).}

\item{clip_negative_log}{Logical, whether to clip negative values to zero before log transformation. Default TRUE.}

\item{collapse_correlated}{Logical, whether to collapse highly correlated metabolites. Default TRUE.}

\item{cor_threshold}{Correlation threshold for collapsing metabolites. Default 0.95.}

\item{assign_result}{Logical, whether to assign the resulting object to the environment. Default TRUE.}

\item{assign_name}{Character, name of the object to assign if \code{assign_result = TRUE}. Default "normalized_data".}

\item{envir}{Environment where to assign the result if \code{assign_result = TRUE}. Default parent.frame().}
}
\value{
Invisibly returns a \code{metabolNorm} object with the normalized data, presence info, checks, and summary.
}
\description{
Normalizes metabolomics data, applies filtering, outlier removal, log transformation,
global imputation, and optionally collapses highly correlated metabolites.
}
\examples{
# Minimal example
raw_data <- data.frame(Sample = paste0("S", 1:5), Met1 = rnorm(5), Met2 = rnorm(5))
meta <- data.frame(Sample = paste0("S", 1:5), Group = c("A","A","B","B","B"))
imp_data <- list(data = raw_data, metadata = meta)

class(imp_data) <- "metabolR"

norm_obj <- metabol.normalize(imp_data)
print(norm_obj)

}
\references{
Xia J, Psychogios N, Young N, Wishart DS. (2009). MetaboAnalyst: a web server for metabolomic data analysis and interpretation. \emph{Nucleic Acids Research}, 37(Web Server issue): W652â€“W660. \url{doi:10.1093/nar/gkp356}
van den Berg RA, Hoefsloot HCJ, Westerhuis JA, Smilde AK, van der Werf MJ. (2006). Centering, scaling, and transformations: improving the biological information content of metabolomics data. \emph{BMC Genomics}, 7:142. \url{doi:10.1186/1471-2164-7-142}
}
