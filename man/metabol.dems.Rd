% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabolDems.R
\name{metabol.dems}
\alias{metabol.dems}
\title{Identify Differentially Expressed Metabolites (DEMs)}
\usage{
metabol.dems(
  normalized_data,
  metadata,
  group_col = "Group",
  p_value = 0.05,
  fc_cutoff = 0.5,
  results = FALSE
)
}
\arguments{
\item{normalized_data}{A \code{metabolNorm} object or a list containing \code{log2_normalized} data.frame/matrix.
Rows are samples, columns are metabolites, must include 'Sample' column.}

\item{metadata}{A data.frame containing at least a column with sample names and a group assignment.}

\item{group_col}{Character, default "Group". Column name in metadata representing group labels.}

\item{p_value}{Numeric, default 0.05. Threshold for significance.}

\item{fc_cutoff}{Numeric, default 0.5. Minimum absolute log2 fold-change for significance.}

\item{results}{Logical, default FALSE. If TRUE, returns full results table; if FALSE, returns invisible NULL.}
}
\value{
If \code{results = TRUE}, a data.frame with columns: \code{Metabolite}, \code{log2FC}, \code{p_value}, \code{Significant}.
Otherwise, prints a brief summary and returns \code{invisible(NULL)}.
}
\description{
Computes log2 fold change and t-test p-values between two groups for each metabolite.
Flags metabolites as significant based on p-value and fold-change cutoff.
}
\examples{
# Minimal example for metabol.dems
expr_matrix <- data.frame(
  Sample = c("S1","S2","S3","S4"),
  Met1   = c(5,6,1,2),
  Met2   = c(2,3,2,3)
)

norm_data <- list(expr_matrix = expr_matrix)
class(norm_data) <- "metabolNorm"

meta <- data.frame(
  Sample = c("S1","S2","S3","S4"),
  Group  = c("A","A","B","B")
)

metabol.dems(norm_data, metadata = meta)

}
\references{
Xia J, Wishart DS (2016). Using MetaboAnalyst 3.0 for Comprehensive
Metabolomics Data Analysis. \emph{Current Protocols in Bioinformatics},
55: 14.10.1–14.10.91. \url{doi:10.1002/cpbi.11}

Storey JD, Tibshirani R (2003). Statistical significance for genomewide
studies. \emph{Proceedings of the National Academy of Sciences},
100(16):9440–9445. \url{doi:10.1073/pnas.1530509100}
}
