% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabolHeatmap.R
\name{metabol.heatmap}
\alias{metabol.heatmap}
\title{Heatmap of Top Variable Metabolites}
\usage{
metabol.heatmap(
  normalized_data,
  metadata = NULL,
  group_colname = "Group",
  top_n = 100,
  cluster_rows = TRUE,
  cluster_cols = TRUE,
  show_rownames = FALSE,
  show_colnames = TRUE,
  palette = (grDevices::colorRampPalette(c("navy", "white", "firebrick3")))(100),
  diff_results = NULL,
  results = FALSE,
  assign_result = FALSE,
  assign_name = "heatmap_data",
  envir = parent.frame()
)
}
\arguments{
\item{normalized_data}{A \code{metabolNorm} object, a list containing a normalized data.frame,
or a numeric data.frame/matrix (samples x metabolites).}

\item{metadata}{A data.frame with at least columns 'Sample' and a group column.}

\item{group_colname}{Character, name of the group column in metadata. Default "Group".}

\item{top_n}{Integer, number of top variable metabolites to include in heatmap. Default 100.}

\item{cluster_rows}{Logical, whether to cluster rows. Default TRUE.}

\item{cluster_cols}{Logical, whether to cluster columns. Default TRUE.}

\item{show_rownames}{Logical, show metabolite names. Default FALSE.}

\item{show_colnames}{Logical, show sample names. Default TRUE.}

\item{palette}{Color palette for heatmap. Default blue-white-red.}

\item{diff_results}{optional, use DEGs identified by \code{metabol.diff}.}

\item{results}{Logical, whether to return a list with z-score matrix and top metabolites. Default FALSE.}

\item{assign_result}{Logical, whether to assign the result object to the environment. Default FALSE.}

\item{assign_name}{Character, name for the assigned object. Default "heatmap_data".}

\item{envir}{Environment in which to assign result object. Default parent.frame().}
}
\value{
Invisibly returns a list (if \code{results = TRUE}) containing:
\describe{
\item{top_metabolites}{Character vector of top variable metabolites.}
\item{expr_z_score}{Z-score matrix of top metabolites (rows = metabolites, cols = samples).}
\item{annotation_col}{Data frame with sample group annotations.}
\item{var_table}{Data frame of variance values for selected metabolites.}
}
}
\description{
Generates a heatmap of the top N most variable metabolites from a normalized metabolomics dataset.
Useful for visualizing patterns of variation across samples or groups.
}
\examples{
# Minimal example
set.seed(123)

expr_mat <- matrix(rnorm(48), nrow = 6)
rownames(expr_mat) <- paste0("S", 1:6)
colnames(expr_mat) <- paste0("M", 1:8)

meta <- data.frame(
  Sample = rownames(expr_mat),
  Group  = rep(c("A","B"), each = 3)
)

minimal_norm <- list(
  expr_matrix = data.frame(
    Sample = rownames(expr_mat),
    expr_mat,
    check.names = FALSE
  ),
  metadata = meta,
  method = "none"
)
class(minimal_norm) <- "metabolNorm"

metabol.heatmap(
  normalized_data = minimal_norm,
  top_n = 3,
  results = FALSE
)


}
\references{
Eisen MB, Spellman PT, Brown PO, Botstein D (1998). Cluster analysis and display of genome-wide expression patterns. \emph{Proceedings of the National Academy of Sciences}, 95(25):14863–14868. \url{doi:10.1073/pnas.95.25.14863}
Xia J, Wishart DS (2016). Using MetaboAnalyst 3.0 for Comprehensive Metabolomics Data Analysis. \emph{Current Protocols in Bioinformatics}, 55:14.10.1–14.10.91. \url{doi:10.1002/cpbi.11}
}
