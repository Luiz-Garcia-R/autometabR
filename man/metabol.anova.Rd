% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metabolAnova.R
\name{metabol.anova}
\alias{metabol.anova}
\title{Comparative Statistical Test for a Metabolite (t-test, ANOVA, Wilcoxon, or Kruskal-Wallis)}
\usage{
metabol.anova(
  normalized_data,
  metadata,
  metabolite,
  group_col = "Group",
  adjust = "BH",
  verbose = TRUE,
  theme_style = ggplot2::theme_minimal()
)
}
\arguments{
\item{normalized_data}{List returned by \code{metabol.normalize()}, containing \code{$expr_matrix}.}

\item{metadata}{Data.frame containing at least columns 'Sample' and the grouping column.}

\item{metabolite}{Character. Name of the metabolite to test.}

\item{group_col}{Character. Column in \code{metadata} defining groups (default = "Group").}

\item{adjust}{Character. P-value adjustment method for non-parametric post-hoc tests (default = "BH").}

\item{verbose}{Logical. Whether to print group means, SDs, and test summaries (default = TRUE).}

\item{theme_style}{ggplot2 theme applied to the plot (default = \code{ggplot2::theme_minimal()}).}
}
\value{
Invisibly returns a list with:
\itemize{
\item \code{model}: test or ANOVA model object.
\item \code{letters}: data.frame with group letters indicating significant differences.
\item \code{summary}: data.frame with group means and standard deviations.
\item \code{plot}: ggplot object showing the boxplot with significance letters.
}
}
\description{
Performs an automatic comparison of a single metabolite across two or more groups,
selecting the appropriate statistical test based on data normality.
For two groups, it performs a t-test or Wilcoxon test.
For more than two groups, it performs ANOVA or Kruskal-Wallis followed by post-hoc tests (Tukey or Dunn).
Significant differences are represented by grouping letters in the plot.
}
\examples{
# Example dataset
set.seed(1)
expr <- data.frame(
  Glucose = c(rnorm(3, 5, 1), rnorm(3, 6, 1), rnorm(3, 8, 1))
)
rownames(expr) <- paste0("S", 1:9)  # força os nomes de amostra
meta <- data.frame(
  Sample = paste0("S", 1:9),
  Group = rep(c("A", "B", "C"), each = 3)
)

norm_data <- list(expr_matrix = expr)
class(norm_data) <- "normalized_data"

metabol.anova(norm_data, metadata = meta, metabolite = "Glucose")

}
\references{
Student. (1908). The probable error of a mean. \emph{Biometrika}, 6(1): 1–25. \url{doi:10.2307/2331554}
Kruskal, W.H., & Wallis, W.A. (1952). Use of ranks in one-criterion variance analysis. \emph{Journal of the American Statistical Association}, 47(260): 583–621. \url{doi:10.1080/01621459.1952.10483441}
Dunn, O.J. (1964). Multiple comparisons using rank sums. \emph{Technometrics}, 6(3): 241–252. \url{doi:10.1080/00401706.1964.10490181}
}
