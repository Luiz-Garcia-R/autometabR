% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metabolOplsda.R
\name{metabol.oplsda}
\alias{metabol.oplsda}
\title{OPLS-DA Analysis for Metabolomics Data}
\usage{
metabol.oplsda(
  normalized_data,
  metadata,
  group_col = "Group",
  predI = 1,
  orthoI = NA,
  crossvalI = 5,
  permI = 100,
  plot = TRUE
)
}
\arguments{
\item{normalized_data}{A \code{metabolNorm} object or numeric matrix/data.frame of metabolite expression (rows = samples, cols = metabolites).}

\item{metadata}{Data.frame containing at least a 'Sample' column and a grouping column.}

\item{group_col}{Character. Column name in \code{metadata} specifying the group/factor. Default "Group".}

\item{predI}{Integer. Number of predictive components. Default 1.}

\item{orthoI}{Integer or NA. Number of orthogonal components. Default NA (automatic selection).}

\item{crossvalI}{Integer. Number of cross-validation folds. Default 5.}

\item{permI}{Integer. Number of permutations for validation. Default 100.}

\item{plot}{Logical. Whether to plot the OPLS-DA scores. Default TRUE.}
}
\value{
Invisibly returns a list containing:
\item{oplsda_res}{The ropls::opls model object.}
\item{scores_df}{Data.frame of predictive and orthogonal scores with group labels.}
\item{plot}{ggplot object (if \code{plot = TRUE}), else NULL.}
}
\description{
Performs Orthogonal Partial Least Squares Discriminant Analysis (OPLS-DA)
on normalized metabolomics data and optionally plots the score plot.
}
\examples{
\dontrun{
# Minimal example
if (requireNamespace("ropls", quietly = TRUE)) {
  set.seed(123)
  raw_data <- data.frame(
    Sample = paste0("S", 1:20),
    Met1 = c(rep(2,10), rep(-2,10)),
    Met2 = c(rep(1,10), rep(-1,10))
  )

  meta <- data.frame(
    Sample = paste0("S", 1:20),
    Group  = rep(c("A","B"), each = 10)
  )

  imp_data <- list(data = raw_data, metadata = meta)
  class(imp_data) <- "metabolR"

  norm_obj <- metabol.normalize(imp_data)

  metabol.oplsda(norm_obj, meta)
  }
}
}
\references{
Trygg J, Wold S. (2002). Orthogonal projections to latent structures (O-PLS). \emph{Journal of Chemometrics}, 16(3): 119–128. \url{doi:10.1002/cem.695}
Worley B, Powers R. (2013). Multivariate Analysis in Metabolomics. \emph{Current Metabolomics}, 1(1): 92–107. \url{doi:10.2174/2213235X11301010092}
}
