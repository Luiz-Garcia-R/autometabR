% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabolDimred.R
\name{metabol.dimred}
\alias{metabol.dimred}
\title{Dimensionality Reduction for Metabolomics Data}
\usage{
metabol.dimred(
  normalized_data,
  group_col = "Group",
  ncomp_plsda = 2,
  n_neighbors = NULL,
  cross_val = 5,
  plot = TRUE,
  verbose = TRUE,
  assign_result = TRUE,
  assign_name = "normalized_data",
  envir = parent.frame()
)
}
\arguments{
\item{normalized_data}{A \code{metabolNorm} object generated by \code{metabol.normalization()}.}

\item{group_col}{Character. Column in metadata defining sample groups.}

\item{ncomp_plsda}{Integer. Number of PLS-DA components. Default = 2.}

\item{n_neighbors}{Integer. Number of neighbors for UMAP.
If NULL, defaults to half of the number of samples.}

\item{cross_val}{Integer. Number of folds for PLS-DA cross-validation. Default = 5.}

\item{plot}{Logical. Whether to plot PCA, UMAP, and PLS-DA figures. Default = TRUE.}

\item{verbose}{Logical. Whether to display messages during execution. Default = TRUE.}

\item{assign_result}{Logical. Whether to assign the result back to the given environment. Default = TRUE.}

\item{assign_name}{Character. Name of the object to be assigned.
If NULL, uses the name of the input object automatically.}

\item{envir}{Environment where the object will be assigned. Default = parent.frame().}
}
\value{
Invisibly returns the updated \code{metabolNorm} object containing:
\describe{
\item{expr_matrix}{Numeric matrix used for dimensionality reduction.}
\item{metadata}{Metadata aligned to expression rows.}
\item{dimred_obj}{A list with:
\describe{
\item{pca_res}{PCA model object from \code{stats::prcomp}.}
\item{umap_res}{UMAP result object from \code{umap::umap}.}
\item{plsda_res}{PLS-DA model object from \code{mixOmics::plsda}.}
\item{plsda_acc}{Cross-validated accuracy estimate.}
}}
\item{vip_scores}{Vector of VIP scores from the PLS-DA model.}
}
}
\description{
Performs PCA, UMAP, and PLS-DA on a \code{metabolNorm} object.
Automatically extracts both expression matrix and metadata from the object.
Returns plots and a structured list including VIP scores from PLS-DA.
}
\examples{
\dontrun{
# Minimal example
set.seed(123)
expr_mat <- matrix(rnorm(100), nrow = 20, ncol = 5)
rownames(expr_mat) <- paste0("S", 1:20)
colnames(expr_mat) <- paste0("Met", 1:5)

meta$Sample <- factor(meta$Sample)
meta <- data.frame(
 Sample = paste0("S", 1:20),
 Group  = rep(c("A","B"), each = 10)
)

res <- metabol.dimred(expr_mat, metadata = meta, cross_val = 3)
}
}
\references{
Jolliffe IT (2002). Principal Component Analysis. 2nd edition. Springer Series in Statistics.
Barker M, Rayens W (2003). Partial least squares for discrimination. \emph{Journal of Chemometrics}, 17:166â€“173. \url{doi:10.1002/cem.785}
McInnes L, Healy J, Melville J (2018). UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction. \emph{arXiv:1802.03426}.
}
