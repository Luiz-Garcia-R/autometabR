% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabolVolcano.R
\name{metabol.volcano}
\alias{metabol.volcano}
\title{Volcano Plot for Metabolomics Differential Analysis}
\usage{
metabol.volcano(
  normalized_data = NULL,
  limma_results = NULL,
  p_thresh = 0.05,
  fc_thresh = 0.5,
  top_labels = 5,
  title = "Volcano plot"
)
}
\arguments{
\item{normalized_data}{Optional object containing a \code{limma_results} field.
Typically the output of \code{metabol.diff()}. Used only when \code{limma_results}
is not supplied.}

\item{limma_results}{A list containing a \code{results} data frame, usually
extracted from \code{metabol.diff()}. Overrides \code{normalized_data$limma_results}.}

\item{p_thresh}{Numeric p-value threshold used to define significance.
Default is \code{0.05}.}

\item{fc_thresh}{Minimum absolute log fold-change used to classify points as
up- or down-regulated. Default is \code{0.5}.}

\item{top_labels}{Number of most significant metabolites to label in the
plot. Default is \code{5}.}

\item{title}{Character title for the plot.}
}
\value{
Invisibly returns the \code{ggplot} object after printing it.
}
\description{
Generates a volcano plot from differential expression results produced by
a limma-based analysis (e.g., from \code{metabol.diff()}). The plot highlights
significantly up- and down-regulated metabolites and optionally labels the
top most significant features.
}
\details{
The function accepts either:
\itemize{
\item an explicit \code{limma_results} list containing a \code{results} data frame, or
\item an object produced by \code{metabol.diff()} that stores results in
\code{normalized_data$limma_results}.
}

Required columns in the results table are \code{"Metabolite"}, \code{"logFC"}, and
\code{"P.Value"}.

Metabolites are classified as:
\itemize{
\item \strong{Up} — \code{P.Value < p_thresh} and \code{logFC >= fc_thresh}
\item \strong{Down} — \code{P.Value < p_thresh} and \code{logFC <= -fc_thresh}
\item \strong{NS} — non-significant
}

The function also highlights the top \code{top_labels} metabolites ranked by
smallest p-value.
}
\examples{
\dontrun{
# Using object generated by metabol.diff()
metabol.volcano(my_norm)

# Providing limma_results manually
metabol.volcano(limma_results = my_norm$limma_results)

# Custom thresholds
metabol.volcano(my_norm, p_thresh = 0.01, fc_thresh = 1)
}

}
