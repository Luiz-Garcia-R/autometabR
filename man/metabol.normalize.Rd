% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabolNormalize.R
\name{metabol.normalize}
\alias{metabol.normalize}
\title{Normalize Metabolomics Data}
\usage{
metabol.normalize(
  imp_data,
  method = "auto",
  remove_zeros = FALSE,
  remove_outliers = TRUE,
  impute = TRUE,
  impute_shift = 1.8,
  impute_scale = 0.3,
  max_missing_prop_per_group = 0.5,
  pseudo_count = NULL,
  clip_negative_log = TRUE,
  collapse_correlated = TRUE,
  cor_threshold = 0.95,
  assign_result = TRUE,
  assign_name = "normalized_data",
  envir = parent.frame(),
  help = FALSE
)
}
\arguments{
\item{imp_data}{A \code{metabolR} object containing raw data (\code{data}) and metadata (\code{metadata}).}

\item{method}{Normalization method. Options:
\itemize{
\item \code{"auto"} – automatically selects the best normalization method based on
coefficient of variation (CV) stability across groups.
\item \code{"log2"} – log2 transformation.
\item \code{"log10"} – log10 transformation.
\item \code{"median"} – sample-wise median normalization.
\item \code{"autoscale"} – z-score scaling.
\item \code{"pareto"} – Pareto scaling.
\item \code{"quantile"} – quantile normalization.
\item \code{"pqn"} – probabilistic quotient normalization.
}
Default is \code{"auto"}.}

\item{remove_zeros}{Logical, whether to remove metabolites that are all zeros. Default FALSE.}

\item{remove_outliers}{Logical, whether to replace outliers with NA. Default TRUE.}

\item{impute}{Logical, whether to perform global imputation. Default TRUE.}

\item{impute_shift}{Shift applied to median for imputation. Default 1.8.}

\item{impute_scale}{Scale applied to SD for imputation. Default 0.3.}

\item{max_missing_prop_per_group}{Maximum allowed missing proportion per group. Default 0.5.}

\item{pseudo_count}{Numeric vector or NULL; pseudo-count per metabolite. Default NULL (computed automatically).}

\item{clip_negative_log}{Logical, whether to clip negative values to zero after log transformation. Default TRUE.}

\item{collapse_correlated}{Logical, whether to collapse highly correlated metabolites. Default TRUE.}

\item{cor_threshold}{Correlation threshold for collapsing metabolites. Default 0.95.}

\item{assign_result}{Logical, whether to assign the resulting object to the environment. Default TRUE.}

\item{assign_name}{Character, name of the object to assign if \code{assign_result = TRUE}. Default "normalized_data".}

\item{envir}{Environment where to assign the result if \code{assign_result = TRUE}. Default parent.frame().}

\item{help}{Logical, if TRUE prints details about the method and exits. Default FALSE.}
}
\value{
Invisibly returns a \code{metabolNorm} object containing:
\itemize{
\item normalized expression matrix,
\item metadata,
\item preserved raw data,
\item selected normalization method.
}
}
\description{
Normalizes metabolomics data, applies filtering, outlier removal, optional automatic
selection of the best normalization method, log transformation, global imputation,
and optional collapsing of highly correlated metabolites.
}
\examples{
# Minimal example
set.seed(123)

# expression data
expr_data <- data.frame(
  Sample = paste0('S', 1:5),
  Met1 = c(5.2, 3.1, 4.8, 5.5, 4.2),
  Met2 = c(2.3, 2.7, 2.5, 2.6, 2.4),
  Met3 = c(8.1, 7.8, 8.5, 8.0, 8.3)
)

# metadata
metadata <- data.frame(
  Sample = paste0('S', 1:5),
  Group = c('A','A','B','B','A')
)

# Create metabolR object
imp_data <- list(data = expr_data, metadata = metadata)
class(imp_data) <- "metabolR"

# Test normalization
norm_res <- metabol.normalize(imp_data)

}
\references{
Xia J, Psychogios N, Young N, Wishart DS. (2009). MetaboAnalyst: a web server for metabolomic data analysis and interpretation. \emph{Nucleic Acids Research}, 37(Web Server issue): W652–W660. \url{doi:10.1093/nar/gkp356}
van den Berg RA, Hoefsloot HCJ, Westerhuis JA, Smilde AK, van der Werf MJ. (2006). Centering, scaling, and transformations: improving the biological information content of metabolomics data. \emph{BMC Genomics}, 7:142. \url{doi:10.1186/1471-2164-7-142}
}
